#!/bin/bash

require-lib bcache-test-libs.sh

config-cache 256M,256M
config-tier 256M,256M,256M,256M,256M,256M,256M,256M,256M,256M

config-bucket-size 64k
config-block-size 4k
config-volume 2000M
config-mem 512M

config-timeout 1200

main()
{
    setup_tracing 64 'bcache:*'

    setup_bcache
    echo 0 > /sys/fs/bcache/*/journal_delay_ms
    test_stress
    stop_bcache
}
